# set the install directory directly
# looking it up does not work. probably because of the symlinks.
Index: pycharm-2016.3/bin/pycharm.sh
===================================================================
--- pycharm-2016.3.orig/bin/pycharm.sh	2016-11-24 18:11:38.846761863 +0100
+++ pycharm-2016.3/bin/pycharm.sh	2016-11-24 18:13:01.968168547 +0100
@@ -50,12 +50,11 @@
   done
 fi
 
-IDE_BIN_HOME=`dirname "$SCRIPT_LOCATION"`
-if [ "$IDE_BIN_HOME" = "." ]; then
-  IDE_HOME=".."
-else
-  IDE_HOME=`dirname "$IDE_BIN_HOME"`
-fi
+IDE_HOME=/usr/share/pycharm
+IDE_BIN_HOME=/usr/share/pycharm/bin
+
+echo "IDE_HOME: " $IDE_HOME
+echo "IDE_BIN_HOME: " $IDE_BIN_HOME
 
 # ---------------------------------------------------------------------
 # Locate a JDK installation directory which will be used to run the IDE.
@@ -75,49 +74,14 @@
 elif [ -n "$JAVA_HOME" -a -x "$JAVA_HOME/bin/java" ]; then
   JDK="$JAVA_HOME"
 else
-  JAVA_BIN_PATH=`which java`
-  if [ -n "$JAVA_BIN_PATH" ]; then
-    if [ "$OS_TYPE" = "FreeBSD" -o "$OS_TYPE" = "MidnightBSD" ]; then
-      JAVA_LOCATION=`JAVAVM_DRYRUN=yes java | "$GREP" '^JAVA_HOME' | "$CUT" -c11-`
-      if [ -x "$JAVA_LOCATION/bin/java" ]; then
-        JDK="$JAVA_LOCATION"
-      fi
-    elif [ "$OS_TYPE" = "SunOS" ]; then
-      JAVA_LOCATION="/usr/jdk/latest"
-      if [ -x "$JAVA_LOCATION/bin/java" ]; then
-        JDK="$JAVA_LOCATION"
-      fi
-    elif [ "$OS_TYPE" = "Darwin" ]; then
-      JAVA_LOCATION=`/usr/libexec/java_home`
-      if [ -x "$JAVA_LOCATION/bin/java" ]; then
-        JDK="$JAVA_LOCATION"
-      fi
-    fi
-
-    if [ -z "$JDK" -a -x "$READLINK" -a -x "$XARGS" -a -x "$DIRNAME" ]; then
-      JAVA_LOCATION=`"$READLINK" -f "$JAVA_BIN_PATH"`
-      case "$JAVA_LOCATION" in
-        */jre/bin/java)
-          JAVA_LOCATION=`echo "$JAVA_LOCATION" | "$XARGS" "$DIRNAME" | "$XARGS" "$DIRNAME" | "$XARGS" "$DIRNAME"`
-          if [ ! -d "$JAVA_LOCATION/bin" ]; then
-            JAVA_LOCATION="$JAVA_LOCATION/jre"
-          fi
-          ;;
-        *)
-          JAVA_LOCATION=`echo "$JAVA_LOCATION" | "$XARGS" "$DIRNAME" | "$XARGS" "$DIRNAME"`
-          ;;
-      esac
-      if [ -x "$JAVA_LOCATION/bin/java" ]; then
-        JDK="$JAVA_LOCATION"
-      fi
-    fi
-  fi
+  JDK=`update-alternatives --list java | grep java-8 | sed 's,jre/bin/java,,'`
 fi
 
 JAVA_BIN="$JDK/bin/java"
 if [ ! -x "$JAVA_BIN" ]; then
   JAVA_BIN="$JDK/jre/bin/java"
 fi
+echo "JAVA_BIN: " $JAVA_BIN
 
 if [ -z "$JDK" ] || [ ! -x "$JAVA_BIN" ]; then
   message "No JDK found. Please validate either PYCHARM_JDK, JDK_HOME or JAVA_HOME environment variable points to valid JDK installation."
